<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>CRM_FACT_ORDER_CAPTURE</name>
    <directory>/</directory>
    <log>
      <read/>
      <write/>
      <input/>
      <output/>
      <update/>
      <connection/>
      <table/>
      <use_batchid>N</use_batchid>
      <use_logfield>N</use_logfield>
      </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
      </maxdate>
    <size_rowset>350</size_rowset>
    <sleep_time_empty>1</sleep_time_empty>
    <sleep_time_full>1</sleep_time_full>
    <dependencies>
      </dependencies>
    </info>
  <notepads>
    <notepad>
      <note>This transformation extracts sales order capture data from PeopleSoft CRM 8.8 and loads a case fact table.</note>
      <xloc>235</xloc>
      <yloc>4</yloc>
      <width>527</width>
      <heigth>23</heigth>
      </notepad>
    </notepads>
  <connection>
    <name>hcm890_sqlserver_pc-xp</name>
    <server>PC-XP</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>hcm890</database>
    <port>1433</port>
    <username>hc</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ce78ddd1fbcf</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>pf890_sqlserver_pc-xp</name>
    <server>PC-XP</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>pf890</database>
    <port>1433</port>
    <username>pf</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ce60d8d1fbcf</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>kettle_mysql_localhost</name>
    <server>192.168.0.159</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>kettle</database>
    <port>3306</port>
    <username>root</username>
    <password>Encrypted </password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>PORT_NUMBER</code><attribute>3306</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>mdw_sqlserver_pc-xp</name>
    <server>PC-XP</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>MDW</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted </password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>mdw_orcl</name>
    <server>192.168.0.103</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>orcl</database>
    <port>1521</port>
    <username>mdw</username>
    <password>Encrypted </password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
    </attributes>
  </connection>
  <order>
  <hop> <from>PSFT_CRM_CASE_METRICS</from><to>CON_BUSINESS_UNIT_TYPE</to><enabled>Y</enabled> </hop>  <hop> <from>CON_BUSINESS_UNIT_TYPE</from><to>LKP_DIMENSION_BUSINESS_UNIT</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_CUSTOMER</from><to>LKP_DIMENSION_CUSTOMER_CONTACT</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_CUSTOMER_CONTACT</from><to>LKP_DIMENSION_PARTNER</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_PARTNER</from><to>LKP_DIMENSION_PARTNER_CONTACT</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_PARTNER_CONTACT</from><to>LKP_DIMENSION_CASE_STATUS</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_CASE_STATUS</from><to>LKP_DIMENSION_REGION</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_REGION</from><to>LKP_DIMENSION_PRODUCT</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_PRODUCT</from><to>LKP_DIMENSION_INSTALLED_PRODUCT</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_INSTALLED_PRODUCT</from><to>LKP_DIMENSION_AGENT</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_AGENT</from><to>LKP_DIMENSION_PRIOR_AGENT</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_PRIOR_AGENT</from><to>LKP_DIMENSION_PROVIDER_GROUP</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_PROVIDER_GROUP</from><to>LKP_DIMENSION_CASE_PRIORITY</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_CASE_PRIORITY</from><to>LKP_DIMENSION_CASE_SEVERITY</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_CASE_SEVERITY</from><to>LKP_DIMENSION_AGREEMENT</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_AGREEMENT</from><to>LKP_DIMENSION_CURRENCY</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_CURRENCY</from><to>FACT_CASE</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_BUSINESS_UNIT</from><to>LKP_DIMENSION_CASE</to><enabled>Y</enabled> </hop>  <hop> <from>LKP_DIMENSION_CASE</from><to>LKP_DIMENSION_CUSTOMER</to><enabled>Y</enabled> </hop>  </order>

  <step>
    <name>CON_BUSINESS_UNIT_TYPE</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
    <fields>
      <field>
        <name>BUSINESS_UNIT_TYPE</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif>RO</nullif>
        <length>2</length>
        <precision>-1</precision>
        </field>
      </fields>
    <GUI>
      <xloc>57</xloc>
      <yloc>95</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>FACT_CASE</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
    <connection>mdw_orcl</connection>
    <commit>0</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <table>FACT_CASE</table>
      <key>
        <name>CASE_ID</name>
        <field>CASE_ID</field>
        <condition>=</condition>
        <name2/>
        </key>
      <key>
        <name>BUSINESS_UNIT_ID</name>
        <field>BUSINESS_UNIT_ID</field>
        <condition>=</condition>
        <name2/>
        </key>
      <value>
        <name>CASE_STATUS_UPDATE_DATE</name>
        <rename>CASE_STATUS_UPDATE_DATE</rename>
        </value>
      <value>
        <name>CASE_ID</name>
        <rename>CASE_ID</rename>
        </value>
      <value>
        <name>BUSINESS_UNIT_ID</name>
        <rename>BUSINESS_UNIT_ID</rename>
        </value>
      <value>
        <name>AGREEMENT_RENEWAL_NUMBER</name>
        <rename>AGREEMENT_RENEWAL_NUMBER</rename>
        </value>
      <value>
        <name>AGREEMENT_LINE_NUMBER</name>
        <rename>AGREEMENT_LINE_NUMBER</rename>
        </value>
      <value>
        <name>CASE_OPEN_DATE</name>
        <rename>CASE_OPEN_DATE</rename>
        </value>
      <value>
        <name>CASE_CLOSED_DATE</name>
        <rename>CASE_CLOSED_DATE</rename>
        </value>
      <value>
        <name>CASE_CLOSED_TIME</name>
        <rename>CASE_CLOSED_TIME</rename>
        </value>
      <value>
        <name>RESPONSE_DATE</name>
        <rename>RESPONSE_DATE</rename>
        </value>
      <value>
        <name>RESPONSE_TIME</name>
        <rename>RESPONSE_TIME</rename>
        </value>
      <value>
        <name>CASE_SLA_QTY</name>
        <rename>CASE_SLA_QTY</rename>
        </value>
      <value>
        <name>SLA_RESPONSE_COMPLIANCE_QTY</name>
        <rename>SLA_RESPONSE_COMPLIANCE_QTY</rename>
        </value>
      <value>
        <name>SLA_RESTORED_COMPLIANCE_QTY</name>
        <rename>SLA_RESTORED_COMPLIANCE_QTY</rename>
        </value>
      <value>
        <name>RESTORED_FIRST_CONTACT_QTY</name>
        <rename>RESTORED_FIRST_CONTACT_QTY</rename>
        </value>
      <value>
        <name>TARGET_CLOSE_DATE</name>
        <rename>TARGET_CLOSE_DATE</rename>
        </value>
      <value>
        <name>ATTEPTED_SOLUTION_QTY</name>
        <rename>ATTEPTED_SOLUTION_QTY</rename>
        </value>
      <value>
        <name>ROW_ADDED_DTTM</name>
        <rename>ROW_ADDED_DTTM</rename>
        </value>
      <value>
        <name>CASE_RESOLVED_QTY</name>
        <rename>CASE_RESOLVED_QTY</rename>
        </value>
      <value>
        <name>STRAIGHT_HOURLY_RATE</name>
        <rename>STRAIGHT_HOURLY_RATE</rename>
        </value>
      <value>
        <name>BUSINESS_UNIT_SK</name>
        <rename>BUSINESS_UNIT_SK</rename>
        </value>
      <value>
        <name>CASE_SK</name>
        <rename>CASE_SK</rename>
        </value>
      <value>
        <name>CUSTOMER_SK</name>
        <rename>CUSTOMER_SK</rename>
        </value>
      <value>
        <name>CUSTOMER_CONTACT_SK</name>
        <rename>CUSTOMER_CONTACT_SK</rename>
        </value>
      <value>
        <name>PARTNER_SK</name>
        <rename>PARTNER_SK</rename>
        </value>
      <value>
        <name>PARTNER_CONTACT_SK</name>
        <rename>PARTNER_CONTACT_SK</rename>
        </value>
      <value>
        <name>CASE_STATUS_SK</name>
        <rename>CASE_STATUS_SK</rename>
        </value>
      <value>
        <name>REGION_SK</name>
        <rename>REGION_SK</rename>
        </value>
      <value>
        <name>PRODUCT_SK</name>
        <rename>PRODUCT_SK</rename>
        </value>
      <value>
        <name>INSTALLED_PRODUCT_SK</name>
        <rename>INSTALLED_PRODUCT_SK</rename>
        </value>
      <value>
        <name>AGENT_ASSIGNED_SK</name>
        <rename>AGENT_ASSIGNED_SK</rename>
        </value>
      <value>
        <name>PRIOR_AGENT_ASSIGNED_SK</name>
        <rename>PRIOR_AGENT_ASSIGNED_SK</rename>
        </value>
      <value>
        <name>PROVIDER_GROUP_SK</name>
        <rename>PROVIDER_GROUP_SK</rename>
        </value>
      <value>
        <name>CASE_PRIORITY_SK</name>
        <rename>CASE_PRIORITY_SK</rename>
        </value>
      <value>
        <name>CASE_SEVERITY_SK</name>
        <rename>CASE_SEVERITY_SK</rename>
        </value>
      <value>
        <name>AGREEMENT_SK</name>
        <rename>AGREEMENT_SK</rename>
        </value>
      <value>
        <name>CURRENCY_SK</name>
        <rename>CURRENCY_SK</rename>
        </value>
      </lookup>
    <GUI>
      <xloc>570</xloc>
      <yloc>536</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_AGENT</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_AGENT</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>AGENT_ASSIGNED_ID</name>
          <lookup>AGENT_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>AGENT_SK</name>
          <rename>AGENT_ASSIGNED_SK</rename>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>274</xloc>
      <yloc>150</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_AGREEMENT</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_AGREEMENT</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>AGREEMENT_ID</name>
          <lookup>AGREEMENT_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>AGREEMENT_SK</name>
          <rename/>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>444</xloc>
      <yloc>382</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_BUSINESS_UNIT</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_BUSINESS_UNIT</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>BUSINESS_UNIT_ID</name>
          <lookup>BUSINESS_UNIT_ID</lookup>
          </key>
        <key>
          <name>BUSINESS_UNIT_TYPE</name>
          <lookup>BUSINESS_UNIT_TYPE</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>BUSINESS_UNIT_SK</name>
          <rename/>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>127</xloc>
      <yloc>165</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_CASE</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_CASE</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>CASE_ID</name>
          <lookup>CASE_ID</lookup>
          </key>
        <key>
          <name>BUSINESS_UNIT_ID</name>
          <lookup>BUSINESS_UNIT_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>CASE_SK</name>
          <rename/>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>56</xloc>
      <yloc>244</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_CASE_PRIORITY</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_CASE_PRIORITY</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>CASE_PRIORITY_ID</name>
          <lookup>CASE_PRIORITY_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>CASE_PRIORITY_SK</name>
          <rename/>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>421</xloc>
      <yloc>180</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_CASE_SEVERITY</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_CASE_SEVERITY</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>CASE_SEVERITY_ID</name>
          <lookup>CASE_SEVERITY_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>CASE_SEVERITY_SK</name>
          <rename/>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>390</xloc>
      <yloc>284</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_CASE_STATUS</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_CASE_STATUS</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>CASE_STATUS_ID</name>
          <lookup>CASE_STATUS_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>CASE_STATUS_SK</name>
          <rename/>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>303</xloc>
      <yloc>537</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_CURRENCY</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_CURRENCY</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>CURRENCY_ID</name>
          <lookup>CURRENCY_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>CURRENCY_SK</name>
          <rename/>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>423</xloc>
      <yloc>488</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_CUSTOMER</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_CUSTOMER</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>CUSTOMER_ID</name>
          <lookup>CUSTOMER_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>CUSTOMER_SK</name>
          <rename/>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>66</xloc>
      <yloc>325</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_CUSTOMER_CONTACT</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_CUSTOMER_CONTACT</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>CUSTOMER_CONTACT_ID</name>
          <lookup>CUSTOMER_CONTACT_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>CUSTOMER_CONTACT_SK</name>
          <rename/>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>119</xloc>
      <yloc>407</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_INSTALLED_PRODUCT</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_INSTALLED_PRODUCT</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>INSTALLED_PRODUCT_ID</name>
          <lookup>INSTALLED_PRODUCT_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>INSTALLED_PRODUCT_SK</name>
          <rename/>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>251</xloc>
      <yloc>241</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_PARTNER</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_PARTNER</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>PARTNER_ID</name>
          <lookup>PARTNER_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>PARTNER_SK</name>
          <rename/>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>65</xloc>
      <yloc>507</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_PARTNER_CONTACT</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_PARTNER_CONTACT</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>PARTNER_CONTACT_ID</name>
          <lookup>PARTNER_CONTACT_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>PARTNER_CONTACT_SK</name>
          <rename/>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>156</xloc>
      <yloc>580</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_PRIOR_AGENT</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_AGENT</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>PRIOR_ASSIGNED_AGENT_ID</name>
          <lookup>AGENT_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>AGENT_SK</name>
          <rename>PRIOR_AGENT_ASSIGNED_SK</rename>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>230</xloc>
      <yloc>51</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_PRODUCT</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_PRODUCT</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>PRODUCT_ID</name>
          <lookup>PRODUCT_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>PRODUCT_SK</name>
          <rename/>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>283</xloc>
      <yloc>349</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_PROVIDER_GROUP</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_PROVIDER_GROUP</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>PROVIDER_GROUP_ID</name>
          <lookup>PROVIDER_GROUP_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>PROVIDER_GROUP_SK</name>
          <rename/>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>441</xloc>
      <yloc>65</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>LKP_DIMENSION_REGION</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
      <table>DIMENSION_REGION</table>
      <connection>mdw_sqlserver_pc-xp</connection>
      <commit>0</commit>
      <update>N</update>
      <fields>
        <key>
          <name>REGION_ID</name>
          <lookup>REGION_ID</lookup>
          </key>
        <date>
          <name>CASE_STATUS_UPDATE_DATE</name>
          <from>DW_START_DATE</from>
          <to>DW_STOP_DATE</to>
          </date>
        <return>
          <name>REGION_SK</name>
          <rename/>
          <use_autoinc>Y</use_autoinc>
          <version>DW_VERSION_NUMBER</version>
        </return>
      </fields>
      <sequence/>
      <min_year>1900</min_year>
      <max_year>2199</max_year>
    <GUI>
      <xloc>246</xloc>
      <yloc>461</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>PSFT_CRM_CASE_METRICS</name>
    <type>TableInput</type>
    <description>This step represents a subset of the columns from the PS_RO_HEADER (order header) table. It maintains the order header information.</description>
    <distribute>Y</distribute>
    <copies>1</copies>
    <connection>pf890_sqlserver_pc-xp</connection>
    <sql>SELECT CS.ROW_LASTMANT_DTTM AS CASE_STATUS_UPDATE_DATE, 
CS.CASE_ID, --PK
CS.BUSINESS_UNIT AS BUSINESS_UNIT_ID, --PK
CS.BO_ID_CUST AS CUSTOMER_ID, --ALSO PASS TO SEGMENT DIMENSION
CS.BO_ID_CONTACT AS CUSTOMER_CONTACT_ID,
CS.BO_ID_PARTNER AS PARTNER_ID, 
CS.BO_ID_PART_CONT AS PARTNER_CONTACT_ID, 
CS.REGION_ID, 
CS.PRODUCT_ID, 
CS.INST_PROD_ID AS INSTALLED_PRODUCT_ID,
CS.PROVIDER_GRP_ID AS PROVIDER_GROUP_ID, 
CS.ASSIGNED_TO AS AGENT_ASSIGNED_ID,
CS.PRIOR_ASSIGNED_TO AS PRIOR_ASSIGNED_AGENT_ID, 
CS.AGREEMENT_CODE AS AGREEMENT_ID, 
CS.AGR_RENEWAL_NUM AS AGREEMENT_RENEWAL_NUMBER,--DEGENERATE DIMENSION 
CS.AGREEMENT_LINE AS AGREEMENT_LINE_NUMBER,--DEGENERATE DIMENSION
CS.RC_STATUS AS CASE_STATUS_ID,
CS.RC_PRIORITY AS CASE_PRIORITY_ID, 
CS.RC_SEVERITY AS CASE_SEVERITY_ID, 
CS.CREATION_DATE AS CASE_OPEN_DATE,--ALSO INCLUDES TIME 
CS.CLOSED_DATE AS CASE_CLOSED_DATE, 
CS.CLOSED_DTTM AS CASE_CLOSED_TIME, 
CS.RC_RESP_DATE AS RESPONSE_DATE, 
CS.RC_RESP_TIME AS RESPONSE_TIME,
(CASE WHEN CS.AGREEMENT_CODE &lt;&gt; &apos;&apos; THEN 1 ELSE 0 END) AS CASE_SLA_QTY, 
(CASE WHEN CS.RC_RESP_IND = &apos;Y&apos; THEN 1 ELSE 0 END) AS SLA_RESPONSE_COMPLIANCE_QTY,
(CASE WHEN CS.RC_REST_IND = &apos;Y&apos; THEN 1 ELSE 0 END) AS SLA_RESTORED_COMPLIANCE_QTY,
(CASE WHEN CS.RC_FIRST_CONTACT = &apos;Y&apos; THEN 1 ELSE 0 END) AS RESTORED_FIRST_CONTACT_QTY,
CS.TARGET_CLOSE_DATE,
(Select MAX(RSLV.RSLN_SEQ_NBR) from PS_RC_RESOLUTION RSLV where RSLV.CASE_ID = CS.CASE_ID  and RSLV.BUSINESS_UNIT = CS.BUSINESS_UNIT) AS ATTEPTED_SOLUTION_QTY,
CS.ROW_ADDED_DTTM,
(CASE WHEN (select &apos;X&apos; from PS_RC_RESOLUTION RSLV where RSLV.CASE_ID = CS.CASE_ID and RSLV.BUSINESS_UNIT = CS.BUSINESS_UNIT AND RSLV.RSLN_STATE = &apos;1&apos;) = &apos;X&apos; THEN 1 ELSE 0 END) AS CASE_RESOLVED_QTY,
(CASE WHEN CCM.HOURLY_RT IS NULL THEN CCG.HOURLY_RT ELSE CCM.HOURLY_RT END) AS STRAIGHT_HOURLY_RATE,
(CASE WHEN CCM.HOURLY_RT IS NULL THEN CCG.CURRENCY_CD ELSE CCM.CURRENCY_CD END) AS CURRENCY_ID
--ADD CASE OPEN DAYS FOR CASES WITH VALID OPEN AND CLOSED DATES
FROM PS_RC_CASE CS	
LEFT OUTER JOIN PS_SET_CNTRL_REC RC_STATUS_TBL
ON CS.BUSINESS_UNIT = RC_STATUS_TBL.SETCNTRLVALUE
AND RC_STATUS_TBL.RECNAME = &apos;RC_STATUS_TBL&apos;
LEFT OUTER JOIN PS_RC_STATUS_TBL ST
ON ST.RC_STATUS = CS.RC_STATUS 
AND ST.SETID = RC_STATUS_TBL.SETID
LEFT OUTER JOIN PS_SET_CNTRL_REC RF_COST_CAT_MEM
ON CS.BUSINESS_UNIT = RF_COST_CAT_MEM.SETCNTRLVALUE
AND RF_COST_CAT_MEM.RECNAME = &apos;RF_COST_CAT_MEM&apos;
LEFT OUTER JOIN PS_RF_COST_CAT_MEM CCM 
ON CCM.SETID = RF_COST_CAT_MEM.SETID 
AND CCM.PROVIDER_GRP_ID = CS.PROVIDER_GRP_ID 
and CCM.PERSON_ID = CS.ASSIGNED_TO 
and CCM.COST_CAT_CD = &apos;STRT&apos;
LEFT OUTER JOIN PS_SET_CNTRL_REC RF_COST_CAT_GRP
ON CS.BUSINESS_UNIT = RF_COST_CAT_GRP.SETCNTRLVALUE
AND RF_COST_CAT_GRP.RECNAME = &apos;RF_COST_CAT_GRP&apos;
LEFT OUTER JOIN PS_RF_COST_CAT_GRP CCG 
ON CCG.SETID = RF_COST_CAT_GRP.SETID 
AND CCG.PROVIDER_GRP_ID = CS.PROVIDER_GRP_ID
AND CCG.COST_CAT_CD = &apos;STRT&apos;
--WHERE LASTUPD_EW_DTTM &gt; Last Load Date</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <GUI>
      <xloc>94</xloc>
      <yloc>9</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

</transformation>
